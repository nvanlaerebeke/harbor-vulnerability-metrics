//Start fetching data from the harbor API

using System.Text.Json;
using VulnerabilityMetrics.DataSource;
using VulnerabilityMetrics.DataSource.Harbor;

//Data Provider
var vulnerabilityDataProvider = new VulnerabilityDataProvider(new HarborApi());
vulnerabilityDataProvider.Start();

//Create the api application
var builder = WebApplication.CreateBuilder(args);
var app = builder.Build();

app.MapGet("/metrics", () =>
{

    var jsonString = "[]";
    var result = JsonSerializer.Deserialize<List<Project>>(jsonString);
    return result;
    //return vulnerabilityDataProvider.Get();
});
app.MapGet("/", () => "Hello World");

//Start the application
app.Run();