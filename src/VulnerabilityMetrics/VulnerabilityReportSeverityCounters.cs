using System.Text.Json.Serialization;

namespace VulnerabilityMetrics;

public class VulnerabilityReportSeverityCounters
{
    [JsonPropertyName("project")]
    public string Project { get; init; } = string.Empty;
    
    [JsonPropertyName("registry")]
    public string Repository { get; init; } = string.Empty;
    
    [JsonPropertyName("tag")]
    public string Tag { get; init; } = string.Empty;
    
    [JsonPropertyName("critical")]
    public int Critical { get; set; }
    
    [JsonPropertyName("high")]
    public int High { get; set; }
    
    [JsonPropertyName("medium")]
    public int Medium { get; set; }
    
    [JsonPropertyName("low")]
    public int Low { get; set; }

    public override string ToString()
    {
        return 
            $"vulnerability{{project={Project},repository={Repository},tag={Tag},type=Critical}} {Critical}" +
            Environment.NewLine +
            $"vulnerability{{project={Project},repository={Repository},tag={Tag},type=High}} {High}" +
            Environment.NewLine +
            $"vulnerability{{project={Project},repository={Repository},tag={Tag},type=Medium}} {Medium}" +
            Environment.NewLine +
            $"vulnerability{{project={Project},repository={Repository},tag={Tag},type=Low}} {Low}" +
            Environment.NewLine;
    }
}