using VulnerabilityMetrics.DataSource.Harbor;

namespace VulnerabilityMetrics;

internal static class VulnerabilityReportExtensions
{
    public static VulnerabilityReportSeverityCounters? ToVulnerabilityReportSeverityCounters(this VulnerabilityReport report, string project, string
     repository, string tag)
    {
        if (report?.Report is null)
        {
            return null;
        }
        
        var result = new VulnerabilityReportSeverityCounters
        {
            Project = project,
            Repository = repository,
            Tag = tag
        };
        foreach (var vulnerability in report.Report.Vulnerabilities)
        {
            //ToDo: use enum
            switch (vulnerability.Severity)
            {
                case "Critical":
                    result.Critical++;
                    break;
                case "High":
                    result.High++;
                    break;
                case "Medium" :
                    result.Medium++;
                    break;
                case "Low":
                    result.Low++;
                    break;
            }
        }
        return result;
    }
}